<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="BBBurgerDiy">
<select id="getBurgerDiyList" resultType="bb.com.a.model.Bb_BbsDto" parameterType="Integer">
SELECT A.SEQ, A.BURGER_SEQ buger_seq, 
A.WRITER,
(SELECT NAME FROM BB_MEMBER WHERE SEQ=A.WRITER) ID ,
A.BBS_LIKE, A.DEL, NVL(B.IMAGE_SRC, '없음') IMAGE_SRC, 
(SELECT COUNT(SEQ) FROM BB_LIKE WHERE MEMBER_SEQ=#{seq}) LIKECHECK,
NVL((SELECT price FROM BB_BURGER WHERE SEQ=A.BURGER_SEQ), 0) price,
NVL((SELECT NAME FROM BB_BURGER WHERE SEQ=A.BURGER_SEQ), '버거이름x') burger_name
FROM (SELECT * FROM BB_BBS WHERE DEL=0) A, (SELECT * FROM BB_IMAGE WHERE TABLE_NAME='BB_BURGER') B
WHERE A.SEQ = B.REF_SEQ(+)
ORDER BY SEQ DESC
</select>

<select id="getBurgerDiyDetail"  parameterType="Integer" resultType="bb.com.a.model.BB_DiyBurgerDto">
SELECT A.SEQ, NVL(A.NAME,'버거이름x') NAME, 
 NVL((SELECT NAME FROM BB_INGREDIENT WHERE SEQ=(SELECT BREAD FROM BB_BURGER WHERE SEQ=#{seq} )),'') BREAD_NAME,
 NVL((SELECT NAME FROM BB_INGREDIENT WHERE SEQ=(SELECT INGREDIENT01 FROM BB_BURGER WHERE SEQ=#{seq} )),'') INGREDIENT01_NAME,
 NVL((SELECT NAME FROM BB_INGREDIENT WHERE SEQ=(SELECT INGREDIENT02 FROM BB_BURGER WHERE SEQ=#{seq} )),'') INGREDIENT02_NAME,
 NVL((SELECT NAME FROM BB_INGREDIENT WHERE SEQ=(SELECT INGREDIENT03 FROM BB_BURGER WHERE SEQ=#{seq} )),'') INGREDIENT03_NAME,
 NVL((SELECT NAME FROM BB_INGREDIENT WHERE SEQ=(SELECT INGREDIENT04 FROM BB_BURGER WHERE SEQ=#{seq} )),'') INGREDIENT04_NAME,
 NVL((SELECT NAME FROM BB_INGREDIENT WHERE SEQ=(SELECT INGREDIENT05 FROM BB_BURGER WHERE SEQ=#{seq} )),'') INGREDIENT05_NAME,
 NVL((SELECT NAME FROM BB_INGREDIENT WHERE SEQ=(SELECT INGREDIENT06 FROM BB_BURGER WHERE SEQ=#{seq} )),'') INGREDIENT06_NAME,
 NVL((SELECT NAME FROM BB_INGREDIENT WHERE SEQ=(SELECT INGREDIENT07 FROM BB_BURGER WHERE SEQ=#{seq} )),'') INGREDIENT07_NAME,
 NVL((SELECT NAME FROM BB_INGREDIENT WHERE SEQ=(SELECT INGREDIENT08 FROM BB_BURGER WHERE SEQ=#{seq} )),'') INGREDIENT08_NAME,
 NVL((SELECT NAME FROM BB_INGREDIENT WHERE SEQ=(SELECT INGREDIENT09 FROM BB_BURGER WHERE SEQ=#{seq} )),'') INGREDIENT09_NAME,
A.CREATOR , A.PRICE, A.CAL,A.DEL , NVL(B.IMAGE_SRC,'없음') IMAGE_SRC,
(SELECT NAME FROM BB_MEMBER WHERE SEQ=A.CREATOR) creatorID
FROM BB_BURGER A, (SELECT * FROM BB_IMAGE WHERE TABLE_NAME='BB_BURGER') B
WHERE A.SEQ = B.REF_SEQ(+)
AND A.SEQ=#{seq}
</select>

</mapper>  





